## 操作系统

 我们知道一个`完整的操作系统=内核+apps`，内核负责管理底层硬件资源，包括CPU、内存、磁盘等等，并向上为apps提供系统调用接口，上层apps应用必须通过系统调用方式使用硬件资源，通常并不能直接访问资源。apps就是用户直接接触的应用，比如命令行工具、图形界面工具等（linux的图形界面也是作为可选应用之一，而不像windows是集成到内核中的）。同一个内核加上不同的apps，就构成了不同的操作系统发行版，比如ubuntu、rethat、android（当然内核通常针对不同的发行版会有修改）等等。因此我们可以认为，不同的操作系统发行版本其实就是由应用apps构成的环境的差别（比如默认安装的软件以及链接库、软件包管理、图形界面应用等等）。我们把所有这些apps环境打成一个包，就可以称之为镜像。问题来了，假如我们同时有多个apps环境，能否在同一个内核上运行呢？因为操作系统只负责提供服务，而并不管为谁服务，因此同一个内核之上可以同时运行多个apps环境。比如假设我们现在有ubuntu和fedora的apps环境，即两个发行版镜像，分别位于`/home/int32bit/ubuntu`和`/home/int32bit/fedora`，我们最简单的方式，采用`chroot`工具即可快速切换到指定的应用环境中，相当于同时有多个apps环境在运行。

## 容器技术

我们以上通过chroot方式，好像就已经实现了容器的功能，但其实容器并没有那么简单，工作其实还差得远。首先要作为云资源管理还必须满足：

### 1.资源隔离
因为云计算本质就是集中资源再分配（社会主义），再分配过程就是资源的逻辑划分，提供资源抽象的实现方式比如我们熟悉的虚拟机等，我们把资源抽象一次划分称为单元。单元必须满足隔离性，包括进程隔离、网络隔离、文件系统隔离等，即单元内部只能感知其内部的资源，而不能感知单元以外的资源（包括宿主资源以及其他单元的资源）。
### 2.资源控制
即为单元分配资源量，能控制单元的资源最大使用量。单元不能使用超过分配的资源量。

当然还包括其他很多条件，本文主要基于这两个基本条件进行研究。

显然满足以上两个条件，虚拟机是一种实现方式，这是因为：

* 虚拟机内部是一个独立的隔离环境
* hypervisor能够对虚拟机分配指定的资源

但是虚拟机由带来很多问题，比如：

* 镜像臃肿庞大，不仅包括apps，还必须包括一个庞大的内核
* 创建和启动时间开销大，不利于快速构建重组
* 额外资源开销大，部署密度小
* 性能损耗
* ...

有没有其他实现方式能符合以上两个条件呢？ 答案是：有！

